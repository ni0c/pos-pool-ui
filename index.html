<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

    <title>PHX PoS Pool</title>
    <style>
      .h-num {
        font-size: 20px;
        font-weight: bold;
      }

      .intro-title {
        color: rgb(86, 90, 105);
      }

      .b-shadow {
        box-shadow: rgb(0 0 0 / 5%) 0px 6px 10px;
      }

      .table>:not(:first-child) {
        border-top: 2px solid #dee2e6;
      }

      .left-icon {
        width: 50px;
      }
    </style>
  </head>
  <body class="bg-light">
    <div id='app' class="container d-none">
      
      <div class="row justify-content-end mt-3">
        <div class="col-3">
          <button v-if="!userInfo.connected" class="btn btn-primary" v-on:click="connectWallet">Connect Wallet</button>
          <div v-else>
            <button type="button" class="btn btn-outline-primary">
              {{shortenAccount}}
            </button>
            <!-- &nbsp;<span>{{userInfo.balance}} CFX</span> -->
          </div>
        </div>
      </div>

      <div class="row mt-3">
        <div class="col text-center">
          <h1 style="color: cornflowerblue">PHX PoS Pool</h1>
          <p>Stake your CFX in Conflux PoS to help improve the network's finality and earn PoS rewards</p>
        </div>
      </div>

      <div class="row mt-3 border b-shadow rounded-3 p-4">
        <div class="col-3">
          <div class="left-icon float-start">
            <i class="bi-bank" style="font-size: 40px; color: cornflowerblue;"></i>
          </div>
          <div>
            <div><span class="h-num">{{poolInfo.totalLocked}}</span></div>
            <span class="intro-title">Staking Vault</span>
          </div>
        </div>
        <div class="col-3">
          <div class="left-icon float-start">
            <i class="bi-cash-coin" style="font-size: 40px; color: cornflowerblue;"></i>
          </div>
          <div>
            <div><span class="h-num">{{poolInfo.totalRevenue}}</span></div>
            <span class="intro-title">Total CFX earned</span>
          </div>
        </div>
        <div class="col-3">
          <div class="left-icon float-start">
            <i class="bi-percent" style="font-size: 40px; color: cornflowerblue;"></i>
          </div>
          <div>
            <div><span class="h-num">{{poolInfo.apy}}%</span></div>
            <span class="intro-title">Expected APY</span>
          </div>
        </div>
        <!-- <div class="col-2">
          <div>
            <span class="h-num">{{perFee}}%</span>
          </div>
          <span class="intro-title">Performance Fee</span>
        </div> -->
        <!-- <div class="col-2">
          <div>
            <span class="h-num">{{lastRewardTime}}</span>
          </div>
          <span class="intro-title">Last Reward Time</span>
        </div> -->
        <div class="col-3">
          <div class="left-icon float-start">
            <i class="bi-plug" style="font-size: 40px; color: cornflowerblue;"></i>
          </div>
          <div>
            <div>
              <span class="h-num" style="color:#42b883">{{poolInfo.status}}</span>
            </div>
            <span class="intro-title">Pool Status</span>
          </div>
        </div>
      </div>

      <div class="row mt-4 border b-shadow rounded-3 p-4">
        <div class="col-3">
          <div>
            <div><span class="h-num">{{userStakedCFX}}</span></div>
            <span class="intro-title">My Staked (CFX)</span>
          </div>
          <div class="row mt-2">
            <div class="col-7">
              <input class="form-control" type="number" v-model="stakeCount">
            </div>
            <div class="col-5">
              <button class="btn btn-primary" v-on:click="stake" :disabled="!userInfo.connected">Stake</button>
            </div>
          </div>
          <p class="intro-title mt-1" v-if="userInfo.connected">Balance: {{userInfo.balance}} CFX</p>
        </div>

        <div class="col-3">
          <div>
            <div><span class="h-num">{{userInfo.userInterest}}</span></div>
            <span class="intro-title">My Rewards (CFX)</span>
          </div>
          <button class="btn btn-primary mt-2" v-on:click="claim" :disabled="!userInfo.connected">Claim</button>
          <p class="intro-title mt-1" v-if="userInfo.connected && poolInfo.lastRewardTime > 0">Last Update: {{lastRewardTime}}</p>
        </div>

        <div class="col-3">
          <div>
            <div><span class="h-num">{{unstakeableCFX}}</span></div>
            <span class="intro-title">Unstakeable CFX</span>
          </div>
          <div class="row mt-2">
            <div class="col-7">
              <input class="form-control" type="number" v-model="unstakeCount">
            </div>
            <div class="col-5">
              <button class="btn btn-primary" v-on:click="unstake" :disabled="!userInfo.connected">Unstake</button>
            </div>
          </div>
        </div>

        <div class="col-3">
          <div>
            <div><span class="h-num">{{withdrawableCFX}}</span></div>
            <span class="intro-title">Withdrawable CFX</span>
          </div>
          <button class="btn btn-primary mt-2" v-on:click="withdraw" :disabled="!userInfo.connected">Withdraw</button>
        </div>
      </div>

      <div class="row mt-4 border b-shadow rounded-3 p-4" v-if="userInfo.connected">
        <div class="col-6">
          <table class="table table-striped table-bordered caption-top">
            <caption>Locking votes</caption>
            <thead>
              <tr>
                <th scope="col">Amount (CFX)</th>
                <th scope="col">EndTime</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="item in userInfo.userInQueue">
                <th scope="row">{{item.amount}}</th>
                <td>{{item.endTime}}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="col-6">
          <table class="table table-striped table-bordered caption-top">
            <caption>Unlocking votes</caption>
            <thead>
              <tr>
                <th scope="col">Amount (CFX)</th>
                <th scope="col">EndTime</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="item in userInfo.userOutOueue">
                <th scope="row">{{item.amount}}</th>
                <td>{{item.endTime}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="mt-4">
        <h4>Stake Rules</h4>
      </div>

      <div class="row mt-3 border b-shadow rounded-3 pt-3">
        <div class="col">
          <ul>
            <li>The Stake/Unstake CFX amount must be multiple of 1000</li>
            <li>The lock period of Stake/Unstake is 7 day</li>
            <li>The pool performance fee is {{perFee}}%</li>
          </ul>
        </div>
      </div>

    </div>

    <script src="https://unpkg.com/vue@next"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-conflux-sdk/dist/js-conflux-sdk.umd.min.js"></script>
    <script src="app/PoolABI.js"></script>
    <script src="app/PoSPoolContract.js"></script>
    <script src="app/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  </body>
</html>